# 第 1 章 操作系统的基本概念

### 1.操作系统结构和层次

裸机->操作系统->软件->用户

### 2.操作系统概念

- 是系统最基本最核心的软件，属于系统软件
- 控制和管理硬件和软件资源
- 组织调度工作与资源的分配
- 提供接口和环境

### 3.如何理解操作系统作为系统管理者

**1.处理器管理**

cpu的分配和运行都以进程（或线程）为基本单位，因此对cpu的管理可理解为对进程的管理。进程管理的主要功能包括**进程控制、进程同步、进程通信、死锁处理、处理机调度**等。

**2.存储器管理**

为多道程序的运行提供良好的环境，方便用户使用及提高内存的利用率，主要包括**内存分配与回收、地址映射、内存保护与共享和内存扩充**等功能。

**3.文件管理**

计算机中所有的信息都是以文件的形式存在的，操作系统中负责文件的管理的部分称为文件系统，文件管理包括**文件存储空间的管理、目录管理及文件读写管理和保护**等。

**4.设备管理**

设备管理的主要任务是完成用户的I/O请求，方便用户使用各种设备，并提高设备的利用率，主要包括**缓存管理、设备分配、设备处理和虚拟设备**等功能。

### 4.如何理解提供接口

1.命令接口：**联机命令接口和脱机命令接口**，用户可以直接调用

2.程序接口：**由一组系统调用（也称广义指令）组成**

- 用户通过在程序中使用这些系统调用来请求操作系统为其提供服务，只能通过用户程序间接调用
- 如使用各种外部设备、申请分配和回收内存及其它各种要求

## 5.操作系统特征

**1.并发**

- `并发`：两个或多个事件在同一`时间间隔内`发生，这些事件在宏观上是同时发生的，在微观上是交替发生的， 操作系统的并发性指系统中同时存在着多个运行的程序
- `并行`：两个或多个事件在同一`时刻`发生

**2.共享**

- 资源共享即共享，是指系统中的资源可以`供内存中多个并发执行的进程`共同使用
- 共享分为两类：**互斥共享和同时共享**

**3.虚拟**

- 时分复用技术：如处理器的分时共享
- 空间复用技术：如虚拟存储器

**4.异步**

- 异步：多道程序环境允许多个程序`并发`执行，但由于资源有限，如cpu只有一个，进程的执行并不是一贯到底的，而是走走停停的，它以不可预知的速度向前推进。

### 6.操作系统结构

大内核：管的更多，如进程管理，存储器管理，设备管理。

小内核：时钟，中断，原语

### 7.用户态和核心态切换

**用户态->内核态通过中断。并且中断是唯一途径。**

**核心态->用户态是通过执行一个特权指令，将PSW标志为用户态。**

### 8.系统调用和库函数区别

**普通程序可以直接进行系统调用，也可以使用库函数，有的库函数涉及系统调用有的不涉及。**

编程语言只负责向上提供库函数，有时会将系统调用封装成库函数。

### 9.系统调用执行过程

传递系统调用参数->执行陷入命令（用户态）->执行系统调用相应的服务程序（核心态）->返回用户程序

# 第 2 章 进程管理

### 1.进程组成（**进程由程序段，数据段，PCB组成**）

而其中最重要的就是进程控制块PCB（Process Control Block）

PCB简介：
        PCB中记录了操作系统所需的，用于描述进程的当前情况以及控制进程运行的全部信息。
        PCB的作用是使一个在多道程序环境下不能独立运行的程序（含数据），成为一个能独立运行的基本单位，一个能与其他进程并发执行的进程。
所以说，PCB是进程存在的唯一标志。

### 2.进程的组织方式

**1.链接方式**

执行指针：指向正在运行的进程

就绪队列指针：指向处于就绪态的进程

阻塞队列指针：指向处于阻塞态的进程

**2.索引方式**

![image-20210823143239779](图片\索引方式)

### 3.进程状态（就绪，执行，阻塞，创建，结束）

**1.进程的状态切换**

**就绪->运行、运行->就绪、运行->阻塞、阻塞->就绪**

![image-20210823143609228](图片\进程切换)

### 4.进程通讯

linux下进程通讯：

**管道（pipe）,流管道(s_pipe)和有名管道（FIFO）**

**信号（signal）**

**消息队列**

**共享内存**

共享一块大家都可以访问的空间，一次只能有一个进程进行读或写操作

**信号量**

**套接字（socket)**

### 5.多线程模型

1.多对一模型。

2.一对一模型。

3.多对多模型。

## 6.进程调度

**1.进行进程调度时机**

从就绪队列中选择一个进程为其分配处理机。

**2.不能进行进程调度的场合**

1.处理中断的时候。

2.进程在操作系统内核程序临界区。

3.原子操作过程中。

**3.进程调度方式**

非抢占式调度，抢占式调度

**4.进程切换过程主要为了保存原来各种数据，对新进程的数据进行恢复**

**5.调度算法评价指标（cpu利用率、系统吞吐量、周转时间、等待时间、响应时间）**

### 7.一些进程调度算法（先来先服务，短作业优先，高响应比优先，时间片轮转，优先级调度算法，多级反馈队列调度算法）

**1.先来先服务**

对长期有利对短期不利

**2.短作业优先**

对短期有利对长期不利，可能产生饥饿现象。

**3.高响应比优先**

非抢占式

**4.时间片轮转**

抢占式

**5.优先级调度算法**

**6.多级反馈队列调度算法**

抢占式

![image-20210823151556783](图片\常用进程调度算法1)

![image-20210823151642508](图片\常用进程调度算法2)

### 8.进程同步和互斥

**1.进程同步**

- `同步也称为直接制约关系。`
- 在多道程序环境下，进程是并发执行的，不同进程之间存在着不同的相互制约关系。为了协调进程之间的相互制约关系,如等待、传递信息等，引入了进程同步的概念。进程同步是为了解决进程的异步问题。

**2.进程互斥**
互斥，亦称间接制约关系。**进程互斥指当一个进程访问某临界资源时**，另一个想要访问该临界资源的进程必须等待。当前访问临界资源的进程访问结束，释放该资源之后，另一个进程才能去访问临界资源。

**临界资源：**
我们把一个时间段内只允许一个进程使用的资源称为临界资源。许多物理设备(比如摄像头、打印机)都属于临界资源。此外还有许多变量、数据、内存缓冲区等都属于临界资源。对临界资源的访问，必须互斥地进行。

**访问原则：**

空闲让进，忙则等待，有限等待，让权等待。

**3.进程互斥实现**

1.软件实现

- [1.单标志法](https://blog.csdn.net/weixin_43914604/article/details/104943004#1_8)
- [2.双标志先检查法](https://blog.csdn.net/weixin_43914604/article/details/104943004#2_12)
- [3，双标志后检查法](https://blog.csdn.net/weixin_43914604/article/details/104943004#3_14)
- [4.Peterson算法](https://blog.csdn.net/weixin_43914604/article/details/104943004#4Peterson_16)

2.硬件实现

- [1.中断隐藏方法](https://blog.csdn.net/weixin_43914604/article/details/104944962#1_5)
- [2.TestAndSet指令](https://blog.csdn.net/weixin_43914604/article/details/104944962#2TestAndSet_7)
- [3.Swap指令](https://blog.csdn.net/weixin_43914604/article/details/104944962#3Swap_13)

### 9.信号（为了更好的解决进程互斥与同步）

![image-20210823154810015](图片\信号原理)

### 10.进程同步与互斥经典问题

- [1.生产者-消费者问题](https://blog.csdn.net/weixin_43914604/article/details/105120888#1_6)
- - [（1）问题描述](https://blog.csdn.net/weixin_43914604/article/details/105120888#1_7)
  - [（2）问题分析](https://blog.csdn.net/weixin_43914604/article/details/105120888#2_16)
  - [（3）如何实现？](https://blog.csdn.net/weixin_43914604/article/details/105120888#3_26)
  - [（4）实现互斥的P操作一定要在实现同步的P操作之后](https://blog.csdn.net/weixin_43914604/article/details/105120888#4PP_30)
  - [（5）知识回顾与重要考点](https://blog.csdn.net/weixin_43914604/article/details/105120888#5_33)
- [2.多生产者-多消费者问题](https://blog.csdn.net/weixin_43914604/article/details/105120888#2_38)
- - [（1）问题描述](https://blog.csdn.net/weixin_43914604/article/details/105120888#1_39)
  - [（2）问题分析](https://blog.csdn.net/weixin_43914604/article/details/105120888#2_41)
  - [（3）实现方法](https://blog.csdn.net/weixin_43914604/article/details/105120888#3_43)
  - - [① 有mutex](https://blog.csdn.net/weixin_43914604/article/details/105120888#_mutex_44)
    - [② 无mutex](https://blog.csdn.net/weixin_43914604/article/details/105120888#_mutex_46)
    - [③ 为什么有mutex和没有mutex一样呢？](https://blog.csdn.net/weixin_43914604/article/details/105120888#_mutexmutex_48)
    - [④ 如果有两个盘子plate](https://blog.csdn.net/weixin_43914604/article/details/105120888#_plate_51)
  - [（4）知识总结与重要考点](https://blog.csdn.net/weixin_43914604/article/details/105120888#4_53)
- [3.读者-写者问题](https://blog.csdn.net/weixin_43914604/article/details/105120888#3_59)
- - [（1）问题描述](https://blog.csdn.net/weixin_43914604/article/details/105120888#1_60)
  - [（2）问题分析](https://blog.csdn.net/weixin_43914604/article/details/105120888#2_62)
  - [（3）实现方法](https://blog.csdn.net/weixin_43914604/article/details/105120888#3_64)
  - - [① 给count加mutex互斥访问](https://blog.csdn.net/weixin_43914604/article/details/105120888#_countmutex_66)
    - [② 加一个w实现“读写公平法”](https://blog.csdn.net/weixin_43914604/article/details/105120888#_w_71)
  - [（4）知识回顾与重要考点](https://blog.csdn.net/weixin_43914604/article/details/105120888#4_76)
- [4.吸烟者问题](https://blog.csdn.net/weixin_43914604/article/details/105120888#4_79)
- - [（1）问题描述](https://blog.csdn.net/weixin_43914604/article/details/105120888#1_80)
  - [（2）问题分析](https://blog.csdn.net/weixin_43914604/article/details/105120888#2_83)
  - [（3）实现方法](https://blog.csdn.net/weixin_43914604/article/details/105120888#3_86)
  - [（4）知识回顾与重要考点](https://blog.csdn.net/weixin_43914604/article/details/105120888#4_88)
- [5.哲学家进餐问题](https://blog.csdn.net/weixin_43914604/article/details/105120888#5_91)
- - [（1）问题描述](https://blog.csdn.net/weixin_43914604/article/details/105120888#1_92)
  - [（2）问题分析](https://blog.csdn.net/weixin_43914604/article/details/105120888#2_95)
  - [（3）如何实现](https://blog.csdn.net/weixin_43914604/article/details/105120888#3_98)
  - [（4）知识回顾与重要考点](https://blog.csdn.net/weixin_43914604/article/details/105120888#4_103)

### 11.死锁

![](图片\死锁.png)

# 第 3 章 内存管理

### 1.进程运行基本原理

指令的工作原理：操作码+若干参数（可能包含地址参数）

### 2.写程序到执行程序（编译，链接，装入）

**1.装入策略：**

绝对装入，静态重定位，动态重定位。

**2.链接方式：**

**1.静态链接：**

直接封成可执行文件，不再拆开。

**2.装入时动态链接：**

边装入内存边链接

**3.运行时动态链接：**

需要时再链接

### 3.内存管理内容（分配与回收，实现虚拟性，地址转换，内存保护）

内存保护实现：一对上下限寄存器，重定位寄存器

### 4.内存分配和回收

**1.单一连续分配**

**2.固定分区分配**

使用分区表

**3.动态分区分配（可变分区分配）**

没有内部碎片只有外部碎片

### 5.系统怎样的数据结构记录内存的使用情况（空闲分区表，空闲分区链）

### 6.常用动态分配算法（首次适应算法、最佳适应算法、最坏适应算法、临近适应算法）

![image-20210823163003831](图片\常用分区算法)

### **7.[请求分页管理方式（请求页表、缺页中断机构、地址变换机构）](https://blog.csdn.net/weixin_43914604/article/details/105978678)**

### **8. [页面置换算法（最佳置换算法、先进先出置换算法、最近最久未使用置换算法、普通时钟置换算法、改造型时钟置换算法）](https://blog.csdn.net/weixin_43914604/article/details/105997486)**

### **9.[页面分配策略（驻留集、页面分配、置换策略、抖动现象、工作集）](https://blog.csdn.net/weixin_43914604/article/details/106001486)**

# 第 4 章 文件管理

### 1.文件基本操作过程

![image-20210823170057084](图片\文件基本操作)

